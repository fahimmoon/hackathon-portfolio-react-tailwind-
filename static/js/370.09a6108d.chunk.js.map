{"version":3,"file":"static/js/370.09a6108d.chunk.js","mappings":"2MAGA,MAgGA,EAvFgBA,IAAmB,IAAlB,SAAEC,GAAUD,EAC3B,MAAOE,EAAaC,IAAkBC,EAAAA,EAAAA,UAAS,KACxCC,EAAWC,IAAgBF,EAAAA,EAAAA,UAAS,KACpCG,EAASC,IAAcJ,EAAAA,EAAAA,WAAS,IAChCK,EAAOC,IAAYN,EAAAA,EAAAA,UAAS,KAEnCO,EAAAA,EAAAA,YAAU,KACRC,GAAgB,GACf,IAEH,MAAMA,EAAiBA,KACrBT,EApBoBU,MACtB,MAAMC,EAAQ,uCACd,IAAIC,EAAU,GACd,IAAK,IAAIC,EAAI,EAAGA,EAAI,EAAGA,IACrBD,GAAWD,EAAMG,KAAKC,MAAsBJ,GAAhBG,KAAKE,WAEnC,OAAOJ,CAAO,EAcGF,IACfP,EAAa,IACbE,GAAW,GACXE,EAAS,IACTT,GAAS,EAAM,EAiBjB,OACEmB,EAAAA,EAAAA,MAACC,EAAAA,EAAOC,IAAG,CACTC,QAAS,CAAEC,QAAS,GACpBC,QAAS,CAAED,QAAS,GACpBE,UAAU,mBAAkBC,SAAA,EAG5BP,EAAAA,EAAAA,MAAA,OAAKM,UAAU,yFAAwFC,SAAA,EACrGC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,+CACVG,MAAO,CACLC,MAAO,UACPC,WAAY,8BACZC,cAAe,SACfL,SACJzB,KAEH0B,EAAAA,EAAAA,KAACP,EAAAA,EAAOY,OAAM,CACZC,WAAY,CAAEC,MAAO,MACrBC,SAAU,CAAED,MAAO,KACnBE,QAASzB,EACTc,UAAU,0DACVY,KAAK,SAAQX,SACd,gBAMHP,EAAAA,EAAAA,MAAA,OAAKM,UAAU,0BAAyBC,SAAA,EACtCC,EAAAA,EAAAA,KAAA,SACEU,KAAK,OACLC,MAAOlC,EACPmC,SAAWC,GAAMnC,EAAamC,EAAEC,OAAOH,OACvCI,YAAY,gBACZjB,UAAU,iJAGZE,EAAAA,EAAAA,KAACP,EAAAA,EAAOY,OAAM,CACZC,WAAY,CAAEC,MAAO,MACrBC,SAAU,CAAED,MAAO,KACnBE,QAtDaO,KACfvC,EAAUwC,gBAAkB3C,GAC9BM,GAAW,GACXE,EAAS,IACTT,GAAS,KAETS,EAAS,0BACTF,GAAW,GACXP,GAAS,GACTW,KAEFN,EAAa,GAAG,EA4CVoB,UAAU,2DACVY,KAAK,SAAQX,SACd,cAMFlB,IAASmB,EAAAA,EAAAA,KAAA,KAAGF,UAAU,uBAAsBC,SAAElB,IAC9CF,IAAWqB,EAAAA,EAAAA,KAAA,KAAGF,UAAU,yBAAwBC,SAAC,qCACvC,E,cC3FE,IAAImB,IAAvB,MAwDMC,EAAa,IAAID,IAqBVE,EAAgB,SAACC,GAA6C,IAAtCC,EAASC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,IAAMG,EAAOH,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,KAC/D,IAAKF,GAA0B,kBAAVA,EAAoB,OAAO,EAChD,GAAIA,EAAMG,OAASF,EAAW,OAAO,EAcrC,OAX0B,CACxB,gBACA,eACA,SACA,aACA,WACA,YACA,UACA,iBAGoBK,MAAKD,GAAWA,EAAQE,KAAKP,QAK/CK,IAAYA,EAAQE,KAAKP,GAK/B,ECuMA,EAvSgBQ,KACd,MAAOC,EAAWC,IAAgBvD,EAAAA,EAAAA,WAAS,KACzC,MAAMwD,EAAQC,aAAaC,QAAQ,mBACnC,OAAOF,EAAQG,KAAKC,MAAMJ,GAAS,CACjCK,KAAM,GACNC,MAAO,GACPC,QAAS,GACTC,QAAS,GACV,KAEIC,EAAmBC,IAAwBlE,EAAAA,EAAAA,WAAS,IAE3DO,EAAAA,EAAAA,YAAU,KACRkD,aAAaU,QAAQ,kBAAmBR,KAAKS,UAAUd,GAAW,GACjE,CAACA,IAEJ,MA0EMe,EAAc,CAClB,CAAEC,KAAMC,EAAAA,IAAU7C,MAAO,OAAQ8C,MAAO,SAAUC,IAAK,sBACvD,CAAEH,KAAMI,EAAAA,IAAYhD,MAAO,UAAW8C,MAAO,WAAYC,IAAK,wBAC9D,CAAEH,KAAMK,EAAAA,IAAWjD,MAAO,UAAW8C,MAAO,UAAWC,IAAK,uBAC5D,CAAEH,KAAMM,EAAAA,IAAWlD,MAAO,UAAW8C,MAAO,UAAWC,IAAK,KAC5D,CAAEH,KAAMO,EAAAA,IAASnD,MAAO,UAAW8C,MAAO,QAASC,IAAK,KACxD,CAAEH,KAAMQ,EAAAA,IAAYpD,MAAO,UAAW8C,MAAO,WAAYC,IAAK,KAC9D,CAAEH,KAAMS,EAAAA,IAAYrD,MAAO,UAAW8C,MAAO,WAAYC,IAAK,MAG1DO,EAAc,CAClB,CAAEV,KAAMW,EAAAA,IAAYvD,MAAO,UAAW8C,MAAO,QAASrC,MAAO,0BAC7D,CAAEmC,KAAMY,EAAAA,IAAgBxD,MAAO,UAAW8C,MAAO,WAAYrC,MAAO,YACpE,CAAEmC,KAAMa,EAAAA,IAASzD,MAAO,UAAW8C,MAAO,QAASrC,MAAO,aAC1D,CAAEmC,KAAMc,EAAAA,IAAS1D,MAAO,UAAW8C,MAAO,gBAAiBrC,MAAO,0BAa9DkD,EAAe,CACnBC,OAAQ,CAAEC,EAAG,GAAInE,QAAS,GAC1BoE,QAAS,CACPD,EAAG,EACHnE,QAAS,EACTqE,WAAY,CAAEC,SAAU,MAI5B,OACE1E,EAAAA,EAAAA,MAAA,OAAKM,UAAU,2FAA0FC,SAAA,EACvGC,EAAAA,EAAAA,KAACmE,EAAAA,GAAO,CAACC,SAAS,cAEjB,IAAIC,MAAM,IAAIC,KAAI,CAACC,EAAGnF,KACrBY,EAAAA,EAAAA,KAACP,EAAAA,EAAOC,IAAG,CAETI,UAAU,sBACVD,QAAS,CACP2E,EAAG,CAAC,EAAG,IAAK,GACZT,EAAG,CAAC,GAAI,IAAK,GACbxD,MAAO,CAAC,EAAG,IAAK,IAElB0D,WAAY,CACVC,SAAU,GAAS,EAAJ9E,EACfqF,OAAQC,IACRC,WAAY,WAEd1E,MAAO,CACL2E,KAAyB,IAAhBvF,KAAKE,SAAR,IACNsF,IAAwB,IAAhBxF,KAAKE,SAAR,IACLuF,MAAU,IAAU,GAAJ1F,EAAT,KACP2F,OAAW,IAAU,GAAJ3F,EAAT,KACR4F,WAAY,2BACV,CAAC,UAAW,UAAW,UAAW,UAAW,WAAW5F,4BAlBvDA,MAwBTI,EAAAA,EAAAA,MAACC,EAAAA,EAAOC,IAAG,CACTI,UAAU,oBACVmF,SAnDoB,CACxBnB,OAAQ,CAAElE,QAAS,GACnBoE,QAAS,CACPpE,QAAS,EACTqE,WAAY,CACViB,gBAAiB,MA+CjBvF,QAAQ,SACRE,QAAQ,UAASE,SAAA,EAEjBP,EAAAA,EAAAA,MAACC,EAAAA,EAAOC,IAAG,CACTI,UAAU,oBACVmF,SAAUpB,EAAa9D,SAAA,EAEvBP,EAAAA,EAAAA,MAAA,MAAIM,UAAU,0BAAyBC,SAAA,CAAC,WAC/BC,EAAAA,EAAAA,KAAA,QAAMF,UAAU,eAAcC,SAAC,cAExCC,EAAAA,EAAAA,KAAA,KAAGF,UAAU,kCAAiCC,SAAC,0HAKjDP,EAAAA,EAAAA,MAAA,OAAKM,UAAU,4BAA2BC,SAAA,EACxCC,EAAAA,EAAAA,KAACP,EAAAA,EAAOC,IAAG,CACTuF,SAAUpB,EACV/D,UAAU,2EAA0EC,UAEpFP,EAAAA,EAAAA,MAAA,QAAM2F,SAzJKC,UAInB,GAHAvE,EAAEwE,kBD0B2BC,KAC/B,MAAMC,EAAMC,KAAKD,MAIXE,GAHWtE,EAAWuE,IAAIJ,IAAO,IAGRK,QAAOC,GAAQA,EAAOL,EARnC,MAUlB,QAAIE,EAAcjE,QATQ,OAa1BiE,EAAcI,KAAKN,GACnBpE,EAAW2E,IAAIR,EAAIG,IACZ,EAAI,ECpCJM,CAAiBC,OAAOC,UAE3B,YADAC,EAAAA,GAAMrH,MAAM,8CAId,IAAK4D,EAEH,YADAyD,EAAAA,GAAMrH,MAAM,mCAKd,MAAMsH,EAAc,CAClB9D,KAAMjB,EAAcU,EAAUO,KAAM,IAAK,uBACzCC,MAAOlB,EAAcU,EAAUQ,MAAO,IAAK,8BAC3CC,QAASnB,EAAcU,EAAUS,QAAS,KAC1CC,QAASpB,EAAcU,EAAUU,QAAS,MAGtC4D,EAAgBC,OAAOC,QAAQH,GAClCR,QAAOvH,IAAA,IAAEmG,EAAG5F,GAAQP,EAAA,OAAMO,CAAO,IACjC2F,KAAIiC,IAAA,IAAEC,GAAMD,EAAA,OAAKC,CAAK,IAEzB,GAAIJ,EAAc5E,OAAS,EAEzB,YADA0E,EAAAA,GAAMrH,MAAM,qBAAqBuH,EAAcK,KAAK,SAKtD,MAAMC,EDjDuBC,KAC/B,MAAMC,EAAY,CAAC,EAYnB,OAXAP,OAAOQ,KAAKF,GAAMG,SAAQC,IACC,kBAAdJ,EAAKI,GAEdH,EAAUG,GAAOC,EAAAA,EAAUC,SAASN,EAAKI,GAAM,CAC7CG,aAAc,GACdC,aAAc,KACbC,OAEHR,EAAUG,GAAOJ,EAAKI,EACxB,IAEKH,CAAS,ECoCQS,CAAiBvF,GAEvC,IACE,MAAMwF,QAAiBC,MAAM,eAAgB,CAC3CC,OAAQ,OACRC,QAAS,CACP,eAAgB,mBAChB,eAAgBC,SAASC,cAAc,2BAA2BC,QAClE,mBAAoB,kBAEtBC,YAAa,cACbC,KAAM3F,KAAKS,UAAU,IAChB8D,EACHqB,UAAWvC,KAAKD,MAChByC,aAAcvF,MAIlB,IAAK6E,EAASW,GAAI,CAChB,MAAMpJ,QAAcyI,EAASY,OAC7B,MAAM,IAAIC,MAAMtJ,EAAM2D,SAAW,yBACnC,CAEA0D,EAAAA,GAAMkC,QAAQ,8BAhEhBnG,aAAaoG,WAAW,mBACxBtG,EAAa,CACXM,KAAM,GACNC,MAAO,GACPC,QAAS,GACTC,QAAS,KA6DTE,GAAqB,EACvB,CAAE,MAAO7D,GACPqH,EAAAA,GAAMrH,MAAMA,EAAM2D,SAAW,0BAC7B8F,QAAQzJ,MAAM,sBAAuBA,EACvC,GA4FsCiB,UAAU,YAAWC,SAAA,EACjDP,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOF,UAAU,+CAA8CC,SAAC,UAChEC,EAAAA,EAAAA,KAAA,SACEU,KAAK,OACLC,MAAOmB,EAAUO,KACjBzB,SAAWC,GAAMkB,EAAa,IAAID,EAAWO,KAAMxB,EAAEC,OAAOH,QAC5Db,UAAU,2IACViB,YAAY,kBAGhBvB,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOF,UAAU,+CAA8CC,SAAC,WAChEC,EAAAA,EAAAA,KAAA,SACEU,KAAK,QACLC,MAAOmB,EAAUQ,MACjB1B,SAAWC,GAAMkB,EAAa,IAAID,EAAWQ,MAAOzB,EAAEC,OAAOH,QAC7Db,UAAU,2IACViB,YAAY,uBAGhBvB,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOF,UAAU,+CAA8CC,SAAC,aAChEC,EAAAA,EAAAA,KAAA,SACEU,KAAK,OACLC,MAAOmB,EAAUS,QACjB3B,SAAWC,GAAMkB,EAAa,IAAID,EAAWS,QAAS1B,EAAEC,OAAOH,QAC/Db,UAAU,2IACViB,YAAY,2BAGhBvB,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOF,UAAU,+CAA8CC,SAAC,aAChEC,EAAAA,EAAAA,KAAA,YACEuI,KAAK,IACL5H,MAAOmB,EAAUU,QACjB5B,SAAWC,GAAMkB,EAAa,IAAID,EAAWU,QAAS3B,EAAEC,OAAOH,QAC/Db,UAAU,2IACViB,YAAY,6BAIhBf,EAAAA,EAAAA,KAACwI,EAAO,CAACnK,SAAUqE,KAEnBlD,EAAAA,EAAAA,MAACC,EAAAA,EAAOY,OAAM,CACZC,WAAY,CAAEC,MAAO,MACrBC,SAAU,CAAED,MAAO,KACnBG,KAAK,SACL+H,UAAWhG,EACX3C,UAAW,gIACC2C,EACE,yCACA,gDAAiD1C,SAAA,EAE/DC,EAAAA,EAAAA,KAAC0I,EAAAA,IAAY,CAAC5I,UAAU,YAAY,wBAM1CN,EAAAA,EAAAA,MAACC,EAAAA,EAAOC,IAAG,CAACuF,SAAUpB,EAAc/D,UAAU,YAAWC,SAAA,EACvDP,EAAAA,EAAAA,MAAA,OAAKM,UAAU,2EAA0EC,SAAA,EACvFC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,6BAA4BC,SAAC,yBAC3CC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,YAAWC,SACvByD,EAAYc,KAAI,CAACqE,EAAMC,KACtBpJ,EAAAA,EAAAA,MAACC,EAAAA,EAAOC,IAAG,CAETY,WAAY,CAAEkE,EAAG,GACjB1E,UAAU,0BAAyBC,SAAA,EAEnCC,EAAAA,EAAAA,KAAA,OACEF,UAAU,wDACVG,MAAO,CAAE4I,gBAAiB,GAAGF,EAAKzI,WAAYH,UAE9CC,EAAAA,EAAAA,KAAC2I,EAAK7F,KAAI,CAAChD,UAAU,UAAUG,MAAO,CAAEC,MAAOyI,EAAKzI,YAEtDV,EAAAA,EAAAA,MAAA,OAAAO,SAAA,EACEC,EAAAA,EAAAA,KAAA,KAAGF,UAAU,wBAAuBC,SAAE4I,EAAK3F,SAC3ChD,EAAAA,EAAAA,KAAA,KAAGF,UAAU,aAAYC,SAAE4I,EAAKhI,aAZ7BiI,WAmBbpJ,EAAAA,EAAAA,MAAA,OAAKM,UAAU,2EAA0EC,SAAA,EACvFC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,6BAA4BC,SAAC,qBAC3CC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,yBAAwBC,SACpC8C,EAAYyB,KAAI,CAACwE,EAAQF,KACxBpJ,EAAAA,EAAAA,MAACC,EAAAA,EAAOsJ,EAAC,CAEPC,KAAMF,EAAO7F,IACbnC,OAAO,SACPmI,IAAI,sBACJ3I,WAAY,CAAEyD,GAAI,GAClBvD,SAAU,CAAED,MAAO,KACnBT,UAAU,yFAAwFC,SAAA,EAElGC,EAAAA,EAAAA,KAAA,OACEF,UAAU,wDACVG,MAAO,CAAE4I,gBAAiB,GAAGC,EAAO5I,WAAYH,UAEhDC,EAAAA,EAAAA,KAAC8I,EAAOhG,KAAI,CAAChD,UAAU,UAAUG,MAAO,CAAEC,MAAO4I,EAAO5I,YAE1DF,EAAAA,EAAAA,KAAA,QAAMF,UAAU,wBAAuBC,SAAE+I,EAAO9F,UAd3C4F,qBAsBf,C","sources":["components/ui/Captcha.jsx","utils/security.js","pages/Contact.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { motion } from 'framer-motion';\r\n\r\nconst generateCaptcha = () => {\r\n  const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ';\r\n  let captcha = '';\r\n  for (let i = 0; i < 6; i++) {\r\n    captcha += chars[Math.floor(Math.random() * chars.length)];\r\n  }\r\n  return captcha;\r\n};\r\n\r\nconst Captcha = ({ onVerify }) => {\r\n  const [captchaText, setCaptchaText] = useState('');\r\n  const [userInput, setUserInput] = useState('');\r\n  const [isValid, setIsValid] = useState(false);\r\n  const [error, setError] = useState('');\r\n\r\n  useEffect(() => {\r\n    refreshCaptcha();\r\n  }, []);\r\n\r\n  const refreshCaptcha = () => {\r\n    setCaptchaText(generateCaptcha());\r\n    setUserInput('');\r\n    setIsValid(false);\r\n    setError('');\r\n    onVerify(false);\r\n  };\r\n\r\n  const handleSubmit = () => {\r\n    if (userInput.toUpperCase() === captchaText) {\r\n      setIsValid(true);\r\n      setError('');\r\n      onVerify(true);\r\n    } else {\r\n      setError('CAPTCHA does not match');\r\n      setIsValid(false);\r\n      onVerify(false);\r\n      refreshCaptcha();\r\n    }\r\n    setUserInput('');\r\n  };\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"w-full space-y-3\"\r\n    >\r\n      {/* CAPTCHA Display */}\r\n      <div className=\"flex items-center justify-between p-4 bg-gray-800/50 rounded-lg border border-gray-700\">\r\n        <div className=\"font-mono text-xl tracking-wider select-none\" \r\n             style={{ \r\n               color: '#e5e7eb',\r\n               textShadow: '2px 2px 4px rgba(0,0,0,0.4)',\r\n               letterSpacing: '0.5em'\r\n             }}>\r\n          {captchaText}\r\n        </div>\r\n        <motion.button\r\n          whileHover={{ scale: 1.05 }}\r\n          whileTap={{ scale: 0.95 }}\r\n          onClick={refreshCaptcha}\r\n          className=\"px-2 py-1 text-sm bg-gray-700 hover:bg-gray-600 rounded\"\r\n          type=\"button\"\r\n        >\r\n          Refresh\r\n        </motion.button>\r\n      </div>\r\n\r\n      {/* Input and Verify Button */}\r\n      <div className=\"flex items-center gap-4\">\r\n        <input\r\n          type=\"text\"\r\n          value={userInput}\r\n          onChange={(e) => setUserInput(e.target.value)}\r\n          placeholder=\"Enter CAPTCHA\"\r\n          className=\"flex-1 px-4 py-2 rounded-lg bg-gray-900/50 border border-gray-700 \r\n                   focus:border-red-500 focus:ring-1 focus:ring-red-500 transition-colors\"\r\n        />\r\n        <motion.button\r\n          whileHover={{ scale: 1.02 }}\r\n          whileTap={{ scale: 0.98 }}\r\n          onClick={handleSubmit}\r\n          className=\"px-4 py-2 bg-red-500 hover:bg-red-600 rounded-lg text-sm\"\r\n          type=\"button\"\r\n        >\r\n          Verify\r\n        </motion.button>\r\n      </div>\r\n\r\n      {/* Status Messages */}\r\n      {error && <p className=\"text-red-500 text-sm\">{error}</p>}\r\n      {isValid && <p className=\"text-green-500 text-sm\">CAPTCHA verified successfully!</p>}\r\n    </motion.div>\r\n  );\r\n};\r\n\r\nexport default Captcha;\r\n","import DOMPurify from 'dompurify';\r\nimport { v4 as uuidv4 } from 'uuid';\r\n\r\n// Rate limiting map\r\nconst rateLimits = new Map();\r\n\r\n// Sanitize HTML content with stricter options\r\nexport const sanitizeHtml = (content) => {\r\n  const config = {\r\n    ALLOWED_TAGS: ['b', 'i', 'em', 'strong', 'a'],\r\n    ALLOWED_ATTR: ['href'],\r\n    ALLOW_DATA_ATTR: false,\r\n    ADD_TAGS: [],\r\n    ADD_ATTR: [],\r\n    USE_PROFILES: { html: true }\r\n  };\r\n  return DOMPurify.sanitize(content, config);\r\n};\r\n\r\n// Enhanced form data sanitization\r\nexport const sanitizeFormData = (data) => {\r\n  const sanitized = {};\r\n  Object.keys(data).forEach(key => {\r\n    if (typeof data[key] === 'string') {\r\n      // Remove any potentially harmful characters\r\n      sanitized[key] = DOMPurify.sanitize(data[key], {\r\n        ALLOWED_TAGS: [],\r\n        ALLOWED_ATTR: []\r\n      }).trim();\r\n    } else {\r\n      sanitized[key] = data[key];\r\n    }\r\n  });\r\n  return sanitized;\r\n};\r\n\r\n// Improved email validation\r\nexport const validateEmail = (email) => {\r\n  const re = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,6}$/;\r\n  return re && re.test(String(email).toLowerCase());\r\n};\r\n\r\n// Rate limiting function\r\nexport const checkRateLimit = (key, limit = 5, windowMs = 60000) => {\r\n  const now = Date.now();\r\n  const userHistory = rateLimits.get(key) || [];\r\n  \r\n  // Remove old entries\r\n  const validHistory = userHistory.filter(time => time > now - windowMs);\r\n  \r\n  if (validHistory.length >= limit) {\r\n    return false;\r\n  }\r\n  \r\n  validHistory.push(now);\r\n  rateLimits.set(key, validHistory);\r\n  return true;\r\n};\r\n\r\n// Enhanced rate limiting with IP tracking\r\nconst ipRequests = new Map();\r\nconst RATE_WINDOW = 60 * 1000; // 1 minute\r\nconst MAX_REQUESTS_PER_IP = 100;\r\n\r\nexport const checkIPRateLimit = (ip) => {\r\n  const now = Date.now();\r\n  const requests = ipRequests.get(ip) || [];\r\n  \r\n  // Clean old requests\r\n  const validRequests = requests.filter(time => time > now - RATE_WINDOW);\r\n  \r\n  if (validRequests.length >= MAX_REQUESTS_PER_IP) {\r\n    return false;\r\n  }\r\n  \r\n  validRequests.push(now);\r\n  ipRequests.set(ip, validRequests);\r\n  return true;\r\n};\r\n\r\n// Input validation\r\nexport const validateInput = (input, maxLength = 1000, pattern = null) => {\r\n  if (!input || typeof input !== 'string') return false;\r\n  if (input.length > maxLength) return false;\r\n  \r\n  // Check for common malicious patterns\r\n  const maliciousPatterns = [\r\n    /<[^>]*script/i,\r\n    /javascript:/i,\r\n    /data:/i,\r\n    /vbscript:/i,\r\n    /onload=/i,\r\n    /onclick=/i,\r\n    /eval\\(/i,\r\n    /expression\\(/i\r\n  ];\r\n\r\n  if (maliciousPatterns.some(pattern => pattern.test(input))) {\r\n    return false;\r\n  }\r\n\r\n  // Test against custom pattern if provided\r\n  if (pattern && !pattern.test(input)) {\r\n    return false;\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\n// Token validation\r\nexport const validateToken = (token) => {\r\n  return token && typeof token === 'string' && token.length === 32;\r\n};\r\n\r\n// Session Security\r\nexport const createSecureSession = () => {\r\n  return {\r\n    id: uuidv4(),\r\n    created: Date.now(),\r\n    expires: Date.now() + (24 * 60 * 60 * 1000), // 24 hours\r\n    csrfToken: uuidv4()\r\n  };\r\n};\r\n\r\n// Content security policies\r\nexport const getCSP = () => {\r\n  return {\r\n    'default-src': [\"'self'\"],\r\n    'script-src': [\"'self'\", \"'unsafe-inline'\"],\r\n    'style-src': [\"'self'\", \"'unsafe-inline'\", 'https://fonts.googleapis.com'],\r\n    'img-src': [\"'self'\", 'data:', 'https:'],\r\n    'font-src': [\"'self'\", 'https://fonts.gstatic.com'],\r\n    'frame-ancestors': [\"'none'\"],\r\n    'form-action': [\"'self'\"],\r\n    'base-uri': [\"'self'\"],\r\n    'object-src': [\"'none'\"]\r\n  };\r\n};\r\n\r\n// Password strength checker\r\nexport const checkPasswordStrength = (password) => {\r\n  const minLength = 8;\r\n  const hasUppercase = /[A-Z]/.test(password);\r\n  const hasLowercase = /[a-z]/.test(password);\r\n  const hasNumbers = /\\d/.test(password);\r\n  const hasSpecialChars = /[!@#$%^&*(),.?\":{}|<>]/.test(password);\r\n  \r\n  return {\r\n    isStrong: password.length >= minLength &&\r\n              hasUppercase &&\r\n              hasLowercase &&\r\n              hasNumbers &&\r\n              hasSpecialChars,\r\n    requirements: {\r\n      minLength: password.length >= minLength,\r\n      hasUppercase,\r\n      hasLowercase,\r\n      hasNumbers,\r\n      hasSpecialChars\r\n    }\r\n  };\r\n};\r\n\r\n// Secure headers generator\r\nexport const getSecureHeaders = () => ({\r\n  'Strict-Transport-Security': 'max-age=31536000; includeSubDomains',\r\n  'X-Content-Type-Options': 'nosniff',\r\n  'X-Frame-Options': 'DENY',\r\n  'X-XSS-Protection': '1; mode=block',\r\n  'Referrer-Policy': 'strict-origin-when-cross-origin',\r\n  'Permissions-Policy': 'geolocation=(), microphone=(), camera=()',\r\n  'Cross-Origin-Opener-Policy': 'same-origin',\r\n  'Cross-Origin-Resource-Policy': 'same-origin',\r\n  'Cross-Origin-Embedder-Policy': 'require-corp'\r\n});\r\n","import React, { useState, useEffect } from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport { \r\n  FaGithub, FaLinkedin, FaTwitter, FaEnvelope, FaMapMarkerAlt, \r\n  FaPhone, FaClock, FaDiscord, FaSkype, FaTelegram, FaWhatsapp,\r\n  FaPaperPlane \r\n} from 'react-icons/fa';\r\nimport { toast, Toaster } from 'react-hot-toast';\r\nimport Captcha from '../components/ui/Captcha';\r\nimport { sanitizeFormData, validateEmail, validateInput, checkRateLimit, checkIPRateLimit } from '../utils/security';\r\n\r\nconst Contact = () => {\r\n  const [formState, setFormState] = useState(() => {\r\n    const saved = localStorage.getItem('contactFormData');\r\n    return saved ? JSON.parse(saved) : {\r\n      name: '',\r\n      email: '',\r\n      subject: '',\r\n      message: ''\r\n    };\r\n  });\r\n  const [isCaptchaVerified, setIsCaptchaVerified] = useState(false);\r\n\r\n  useEffect(() => {\r\n    localStorage.setItem('contactFormData', JSON.stringify(formState));\r\n  }, [formState]);\r\n\r\n  const clearSavedData = () => {\r\n    localStorage.removeItem('contactFormData');\r\n    setFormState({\r\n      name: '',\r\n      email: '',\r\n      subject: '',\r\n      message: ''\r\n    });\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    // Enhanced security checks\r\n    if (!checkIPRateLimit(window.clientIP)) {\r\n      toast.error('Too many requests. Please try again later.');\r\n      return;\r\n    }\r\n\r\n    if (!isCaptchaVerified) {\r\n      toast.error('Please verify the CAPTCHA first');\r\n      return;\r\n    }\r\n\r\n    // Enhanced input validation\r\n    const validations = {\r\n      name: validateInput(formState.name, 100, /^[a-zA-Z\\s]{2,100}$/),\r\n      email: validateInput(formState.email, 100, /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/),\r\n      subject: validateInput(formState.subject, 200),\r\n      message: validateInput(formState.message, 1000)\r\n    };\r\n\r\n    const invalidFields = Object.entries(validations)\r\n      .filter(([_, isValid]) => !isValid)\r\n      .map(([field]) => field);\r\n\r\n    if (invalidFields.length > 0) {\r\n      toast.error(`Invalid input in: ${invalidFields.join(', ')}`);\r\n      return;\r\n    }\r\n\r\n    // Sanitize form data\r\n    const sanitizedData = sanitizeFormData(formState);\r\n\r\n    try {\r\n      const response = await fetch('/api/contact', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'X-CSRF-Token': document.querySelector('meta[name=\"csrf-token\"]').content,\r\n          'X-Requested-With': 'XMLHttpRequest'\r\n        },\r\n        credentials: 'same-origin',\r\n        body: JSON.stringify({\r\n          ...sanitizedData,\r\n          timestamp: Date.now(),\r\n          captchaToken: isCaptchaVerified\r\n        })\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const error = await response.json();\r\n        throw new Error(error.message || 'Failed to send message');\r\n      }\r\n\r\n      toast.success('Message sent successfully!');\r\n      clearSavedData();\r\n      setIsCaptchaVerified(false);\r\n    } catch (error) {\r\n      toast.error(error.message || 'Failed to send message');\r\n      console.error('Contact form error:', error);\r\n    }\r\n  };\r\n\r\n  const socialLinks = [\r\n    { icon: FaGithub, color: \"#333\", label: \"GitHub\", url: \"https://github.com\" },\r\n    { icon: FaLinkedin, color: \"#0077B5\", label: \"LinkedIn\", url: \"https://linkedin.com\" },\r\n    { icon: FaTwitter, color: \"#1DA1F2\", label: \"Twitter\", url: \"https://twitter.com\" },\r\n    { icon: FaDiscord, color: \"#7289DA\", label: \"Discord\", url: \"#\" },\r\n    { icon: FaSkype, color: \"#00AFF0\", label: \"Skype\", url: \"#\" },\r\n    { icon: FaTelegram, color: \"#0088cc\", label: \"Telegram\", url: \"#\" },\r\n    { icon: FaWhatsapp, color: \"#25D366\", label: \"WhatsApp\", url: \"#\" }\r\n  ];\r\n\r\n  const contactInfo = [\r\n    { icon: FaEnvelope, color: \"#FF4B4B\", label: \"Email\", value: \"moonhunzai83@gmail.com\" },\r\n    { icon: FaMapMarkerAlt, color: \"#4CAF50\", label: \"Location\", value: \"Pakistan\" },\r\n    { icon: FaPhone, color: \"#2196F3\", label: \"Phone\", value: \"032622598\" },\r\n    { icon: FaClock, color: \"#FFC107\", label: \"Working Hours\", value: \"Mon - Fri: 9AM to 6PM\" }\r\n  ];\r\n\r\n  const containerVariants = {\r\n    hidden: { opacity: 0 },\r\n    visible: {\r\n      opacity: 1,\r\n      transition: {\r\n        staggerChildren: 0.1\r\n      }\r\n    }\r\n  };\r\n\r\n  const itemVariants = {\r\n    hidden: { y: 20, opacity: 0 },\r\n    visible: {\r\n      y: 0,\r\n      opacity: 1,\r\n      transition: { duration: 0.5 }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-b from-gray-900 to-black py-12 px-4 relative overflow-hidden\">\r\n      <Toaster position=\"top-right\" />\r\n      \r\n      {[...Array(5)].map((_, i) => (\r\n        <motion.div\r\n          key={i}\r\n          className=\"absolute opacity-30\"\r\n          animate={{\r\n            x: [0, 100, 0],\r\n            y: [0, -100, 0],\r\n            scale: [1, 1.2, 1],\r\n          }}\r\n          transition={{\r\n            duration: 15 + i * 2,\r\n            repeat: Infinity,\r\n            repeatType: \"reverse\",\r\n          }}\r\n          style={{\r\n            left: `${Math.random() * 100}%`,\r\n            top: `${Math.random() * 100}%`,\r\n            width: `${150 + i * 50}px`,\r\n            height: `${150 + i * 50}px`,\r\n            background: `radial-gradient(circle, ${\r\n              ['#FF0080', '#7928CA', '#FF4D4D', '#0070F3', '#00DFD8'][i]\r\n            } 0%, transparent 70%)`\r\n          }}\r\n        />\r\n      ))}\r\n\r\n      <motion.div \r\n        className=\"max-w-6xl mx-auto\"\r\n        variants={containerVariants}\r\n        initial=\"hidden\"\r\n        animate=\"visible\"\r\n      >\r\n        <motion.div \r\n          className=\"text-center mb-12\"\r\n          variants={itemVariants}\r\n        >\r\n          <h1 className=\"text-4xl font-bold mb-4\">\r\n            Get in <span className=\"text-red-500\">Touch</span>\r\n          </h1>\r\n          <p className=\"text-gray-400 max-w-2xl mx-auto\">\r\n            Have a question or want to work together? Drop me a message below or reach out through any of my social channels.\r\n          </p>\r\n        </motion.div>\r\n\r\n        <div className=\"grid md:grid-cols-2 gap-8\">\r\n          <motion.div\r\n            variants={itemVariants}\r\n            className=\"bg-gray-800/50 p-6 rounded-xl backdrop-blur-sm border border-gray-700/50\"\r\n          >\r\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium mb-1 text-gray-300\">Name</label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={formState.name}\r\n                  onChange={(e) => setFormState({...formState, name: e.target.value})}\r\n                  className=\"w-full px-4 py-2 rounded-lg bg-gray-900/50 border border-gray-700 focus:border-red-500 focus:ring-1 focus:ring-red-500 transition-colors\"\r\n                  placeholder=\"Your name\"\r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium mb-1 text-gray-300\">Email</label>\r\n                <input\r\n                  type=\"email\"\r\n                  value={formState.email}\r\n                  onChange={(e) => setFormState({...formState, email: e.target.value})}\r\n                  className=\"w-full px-4 py-2 rounded-lg bg-gray-900/50 border border-gray-700 focus:border-red-500 focus:ring-1 focus:ring-red-500 transition-colors\"\r\n                  placeholder=\"your@email.com\"\r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium mb-1 text-gray-300\">Subject</label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={formState.subject}\r\n                  onChange={(e) => setFormState({...formState, subject: e.target.value})}\r\n                  className=\"w-full px-4 py-2 rounded-lg bg-gray-900/50 border border-gray-700 focus:border-red-500 focus:ring-1 focus:ring-red-500 transition-colors\"\r\n                  placeholder=\"What's this about?\"\r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium mb-1 text-gray-300\">Message</label>\r\n                <textarea\r\n                  rows=\"4\"\r\n                  value={formState.message}\r\n                  onChange={(e) => setFormState({...formState, message: e.target.value})}\r\n                  className=\"w-full px-4 py-2 rounded-lg bg-gray-900/50 border border-gray-700 focus:border-red-500 focus:ring-1 focus:ring-red-500 transition-colors\"\r\n                  placeholder=\"Your message here...\"\r\n                />\r\n              </div>\r\n\r\n              <Captcha onVerify={setIsCaptchaVerified} />\r\n\r\n              <motion.button\r\n                whileHover={{ scale: 1.02 }}\r\n                whileTap={{ scale: 0.98 }}\r\n                type=\"submit\"\r\n                disabled={!isCaptchaVerified}\r\n                className={`w-full py-3 px-4 rounded-lg font-medium flex items-center justify-center gap-2 transition-colors\r\n                          ${isCaptchaVerified \r\n                            ? 'bg-red-600 hover:bg-red-700 text-white' \r\n                            : 'bg-gray-600 text-gray-300 cursor-not-allowed'}`}\r\n              >\r\n                <FaPaperPlane className=\"text-sm\" />\r\n                Send Message\r\n              </motion.button>\r\n            </form>\r\n          </motion.div>\r\n\r\n          <motion.div variants={itemVariants} className=\"space-y-6\">\r\n            <div className=\"bg-gray-800/50 p-6 rounded-xl backdrop-blur-sm border border-gray-700/50\">\r\n              <h2 className=\"text-xl font-semibold mb-4\">Contact Information</h2>\r\n              <div className=\"space-y-4\">\r\n                {contactInfo.map((info, index) => (\r\n                  <motion.div\r\n                    key={index}\r\n                    whileHover={{ x: 5 }}\r\n                    className=\"flex items-center gap-4\"\r\n                  >\r\n                    <div \r\n                      className=\"w-10 h-10 rounded-lg flex items-center justify-center\"\r\n                      style={{ backgroundColor: `${info.color}20` }}\r\n                    >\r\n                      <info.icon className=\"w-5 h-5\" style={{ color: info.color }} />\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"text-sm text-gray-400\">{info.label}</p>\r\n                      <p className=\"text-white\">{info.value}</p>\r\n                    </div>\r\n                  </motion.div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-gray-800/50 p-6 rounded-xl backdrop-blur-sm border border-gray-700/50\">\r\n              <h2 className=\"text-xl font-semibold mb-4\">Connect With Me</h2>\r\n              <div className=\"grid grid-cols-4 gap-4\">\r\n                {socialLinks.map((social, index) => (\r\n                  <motion.a\r\n                    key={index}\r\n                    href={social.url}\r\n                    target=\"_blank\"\r\n                    rel=\"noopener noreferrer\"\r\n                    whileHover={{ y: -5 }}\r\n                    whileTap={{ scale: 0.95 }}\r\n                    className=\"flex flex-col items-center gap-2 p-3 rounded-lg hover:bg-gray-700/50 transition-colors\"\r\n                  >\r\n                    <div \r\n                      className=\"w-10 h-10 rounded-lg flex items-center justify-center\"\r\n                      style={{ backgroundColor: `${social.color}20` }}\r\n                    >\r\n                      <social.icon className=\"w-5 h-5\" style={{ color: social.color }} />\r\n                    </div>\r\n                    <span className=\"text-xs text-gray-400\">{social.label}</span>\r\n                  </motion.a>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </motion.div>\r\n        </div>\r\n      </motion.div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Contact;\r\n"],"names":["_ref","onVerify","captchaText","setCaptchaText","useState","userInput","setUserInput","isValid","setIsValid","error","setError","useEffect","refreshCaptcha","generateCaptcha","chars","captcha","i","Math","floor","random","_jsxs","motion","div","initial","opacity","animate","className","children","_jsx","style","color","textShadow","letterSpacing","button","whileHover","scale","whileTap","onClick","type","value","onChange","e","target","placeholder","handleSubmit","toUpperCase","Map","ipRequests","validateInput","input","maxLength","arguments","length","undefined","pattern","some","test","Contact","formState","setFormState","saved","localStorage","getItem","JSON","parse","name","email","subject","message","isCaptchaVerified","setIsCaptchaVerified","setItem","stringify","socialLinks","icon","FaGithub","label","url","FaLinkedin","FaTwitter","FaDiscord","FaSkype","FaTelegram","FaWhatsapp","contactInfo","FaEnvelope","FaMapMarkerAlt","FaPhone","FaClock","itemVariants","hidden","y","visible","transition","duration","Toaster","position","Array","map","_","x","repeat","Infinity","repeatType","left","top","width","height","background","variants","staggerChildren","onSubmit","async","preventDefault","ip","now","Date","validRequests","get","filter","time","push","set","checkIPRateLimit","window","clientIP","toast","validations","invalidFields","Object","entries","_ref2","field","join","sanitizedData","data","sanitized","keys","forEach","key","DOMPurify","sanitize","ALLOWED_TAGS","ALLOWED_ATTR","trim","sanitizeFormData","response","fetch","method","headers","document","querySelector","content","credentials","body","timestamp","captchaToken","ok","json","Error","success","removeItem","console","rows","Captcha","disabled","FaPaperPlane","info","index","backgroundColor","social","a","href","rel"],"sourceRoot":""}